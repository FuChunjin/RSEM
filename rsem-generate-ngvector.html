<?xml version="1.0" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>rsem-generate-ngvector</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rev="made" href="mailto:root@osx316.apple.com" />
</head>

<body style="background-color: white">



<ul id="index">
  <li><a href="#NAME">NAME</a></li>
  <li><a href="#SYNOPSIS">SYNOPSIS</a></li>
  <li><a href="#ARGUMENTS">ARGUMENTS</a></li>
  <li><a href="#OPTIONS">OPTIONS</a></li>
  <li><a href="#DESCRIPTION">DESCRIPTION</a></li>
  <li><a href="#OUTPUT">OUTPUT</a></li>
  <li><a href="#EXAMPLES">EXAMPLES</a></li>
</ul>

<h1 id="NAME">NAME</h1>

<p>rsem-generate-ngvector - Create Ng vector for EBSeq based only on transcript sequences.</p>

<h1 id="SYNOPSIS">SYNOPSIS</h1>

<p>rsem-generate-ngvector [options] input_fasta_file output_name</p>

<h1 id="ARGUMENTS">ARGUMENTS</h1>

<dl>

<dt id="input_fasta_file"><b>input_fasta_file</b></dt>
<dd>

<p>The fasta file containing all reference transcripts. The transcripts must be in the same order as those in expression value files. Thus, &#39;reference_name.transcripts.fa&#39; generated by &#39;rsem-prepare-reference&#39; should be used.</p>

</dd>
<dt id="output_name"><b>output_name</b></dt>
<dd>

<p>The name of all output files. The Ng vector will be stored as &#39;output_name.ngvec&#39;.</p>

</dd>
</dl>

<h1 id="OPTIONS">OPTIONS</h1>

<dl>

<dt id="k-int"><b>-k</b> &lt;int&gt;</dt>
<dd>

<p>k mer length. See description section. (Default: 25)</p>

</dd>
<dt id="h---help"><b>-h/--help</b></dt>
<dd>

<p>Show help information.</p>

</dd>
</dl>

<h1 id="DESCRIPTION">DESCRIPTION</h1>

<p>This program generates the Ng vector required by EBSeq for isoform level differential expression analysis based on reference sequences only. EBSeq can take variance due to read mapping ambiguity into consideration by grouping isoforms with parent gene&#39;s number of isoforms. However, for de novo assembled transcriptome, it is hard to obtain an accurate gene-isoform relationship. Instead, this program groups isoforms by using measures on read mappaing ambiguity directly. First, it calculates the &#39;unmappability&#39; of each transcript. The &#39;unmappability&#39; of a transcript is the ratio between the number of k mers with at least one perfect match to other transcripts and the total number of k mers of this transcript, where k is a parameter. Then, Ng vector is generated by applying Kmeans algorithm to the &#39;unmappability&#39; values with number of clusters set as 3. &#39;rsem-generate-ngvector&#39; will make sure the mean &#39;unmappability&#39; scores for clusters are in ascending order. All transcripts whose lengths are less than k are assigned to cluster 3.</p>

<p>If your reference is a de novo assembled transcript set, you should run &#39;rsem-generate-ngvector&#39; first. Then load the resulting &#39;output_name.ngvec&#39; into R. For example, you can use</p>

<pre><code> NgVec &lt;- scan(file=&quot;output_name.ngvec&quot;, what=0, sep=&quot;\n&quot;)</code></pre>

<p>. After that, replace &#39;IsoNgTrun&#39; with &#39;NgVec&#39; in the second line of section 3.2.5 (Page 10) of EBSeq&#39;s vignette:</p>

<pre><code> IsoEBres=EBTest(Data=IsoMat, NgVector=NgVec, ...)</code></pre>

<p>This program only needs to run once per RSEM reference.</p>

<h1 id="OUTPUT">OUTPUT</h1>

<dl>

<dt id="output_name.ump"><b>output_name.ump</b></dt>
<dd>

<p>&#39;unmappability&#39; scores for each transcript. This file contains two columns. The first column is transcript name and the second column is &#39;unmappability&#39; score.</p>

</dd>
<dt id="output_name.ngvec"><b>output_name.ngvec</b></dt>
<dd>

<p>Ng vector generated by this program.</p>

</dd>
</dl>

<h1 id="EXAMPLES">EXAMPLES</h1>

<p>Suppose the reference sequences file is &#39;/ref/mouse_125/mouse_125.transcripts.fa&#39; and we set the output_name as &#39;mouse_125&#39;:</p>

<pre><code> rsem-generate-ngvector /ref/mouse_125/mouse_125.transcripts.fa mouse_125</code></pre>


</body>

</html>


